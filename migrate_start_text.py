"""
–ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ /start –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
"""
import asyncio
import database
from database import init_db, set_setting

DEFAULT_START_TEXT = """<b>–ü—Ä–∏–≤–µ—Ç</b>, {user_link} üòé

–ú–µ–Ω—è –∑–æ–≤—É—Ç –õ–∞–º–±–∏, —è –ø–æ–º–æ–≥—É —Å –ø–æ–∏—Å–∫–æ–º –Ω—É–∂–Ω–æ–π —Ç–µ–±–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

–ê –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º—É, —Ç—ã –º–æ–∂–µ—à—å –¥–µ–ª–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –Ω–µ —Ç–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ –∏ –≤ –ø–∞—Ä—É –∫–ª–∏–∫–æ–≤, –Ω–æ –∏ –≥–¥–µ —É–≥–æ–¥–Ω–æ: –≤ –ª–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–ø–∏—Å–∫–∞—Ö, —á–∞—Ç–∞—Ö –∏ –∫–∞–Ω–∞–ª–∞—Ö.
<blockquote>–ß—Ç–æ–±—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–æ–º, –≤–≤–µ–¥–∏ –≤ —Å—Ç—Ä–æ–∫–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —é–∑–µ—Ä –±–æ—Ç–∞ –∏ –≤—ã–±–∏—Ä–∞–π –Ω—É–∂–Ω—ã–π –ø—É–Ω–∫—Ç</blockquote>

<b>–ë–ª–æ–≥ –≤–ª–∞–¥–µ–ª—å—Ü–∞: t.me/+2m6vI9IYsBA0NTYy</b>
<b>–õ—É—á—à–∏–π —á–∞—Ç: t.me/+Mo58T7pcKxpmNjYy</b>"""

async def migrate():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç /start –≤ –±–∞–∑—É"""
    print("üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ /start...")

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ë–î
    await init_db()

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç
    success = await set_setting('start_text', DEFAULT_START_TEXT)

    if success:
        print("‚úÖ –¢–µ–∫—Å—Ç /start –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!")
        print(f"üìù –¢–µ–∫—Å—Ç:\n{DEFAULT_START_TEXT}")
    else:
        print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞")

    # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    await database.close_pool()

if __name__ == "__main__":
    asyncio.run(migrate())
